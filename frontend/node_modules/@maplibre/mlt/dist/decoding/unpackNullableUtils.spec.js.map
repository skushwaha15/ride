{"version":3,"file":"unpackNullableUtils.spec.js","sourceRoot":"","sources":["../../src/decoding/unpackNullableUtils.spec.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,QAAQ,EAAE,EAAE,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAC9C,OAAO,EAAE,cAAc,EAAE,qBAAqB,EAAE,MAAM,uBAAuB,CAAC;AAC9E,OAAO,SAAS,MAAM,0BAA0B,CAAC;AACjD,OAAO,EAAE,YAAY,EAAE,mBAAmB,EAAE,MAAM,+BAA+B,CAAC;AAElF,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;IACjC,QAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE;QAC5B,EAAE,CAAC,2DAA2D,EAAE,GAAG,EAAE;YACjE,MAAM,UAAU,GAAG,IAAI,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAC7C,MAAM,MAAM,GAAG,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;YAC9C,MAAM,MAAM,GAAG,cAAc,CAAC,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;YAE/C,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QACtD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gEAAgE,EAAE,GAAG,EAAE;YACtE,MAAM,UAAU,GAAG,IAAI,YAAY,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;YACrD,MAAM,MAAM,GAAG,cAAc,CAAC,UAAU,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;YAExD,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,YAAY,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;QAC9D,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mEAAmE,EAAE,GAAG,EAAE;YACzE,MAAM,UAAU,GAAG,IAAI,aAAa,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;YACtD,MAAM,MAAM,GAAG,cAAc,CAAC,UAAU,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;YAEpD,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,aAAa,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gEAAgE,EAAE,GAAG,EAAE;YACtE,MAAM,UAAU,GAAG,IAAI,aAAa,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;YACtD,MAAM,WAAW,GAAG,IAAI,SAAS,CAAC,IAAI,UAAU,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAC9D,MAAM,MAAM,GAAG,YAAY,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;YACrD,MAAM,MAAM,GAAG,cAAc,CAAC,MAAM,EAAE,WAAW,EAAE,EAAE,CAAC,CAAC;YAEvD,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,aAAa,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+DAA+D,EAAE,GAAG,EAAE;YACrE,MAAM,UAAU,GAAG,IAAI,UAAU,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,yBAAyB;YACzE,MAAM,WAAW,GAAG,IAAI,SAAS,CAAC,IAAI,UAAU,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAC9D,MAAM,MAAM,GAAG,YAAY,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;YACrD,MAAM,MAAM,GAAG,cAAc,CAAC,MAAM,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;YAEtD,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,UAAU,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;QACxD,CAAC,CAAC,CAAC;IACP,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,uBAAuB,EAAE,GAAG,EAAE;QACnC,EAAE,CAAC,2DAA2D,EAAE,GAAG,EAAE;YACjE,MAAM,UAAU,GAAG,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YAChD,MAAM,MAAM,GAAG,mBAAmB,CAAC,UAAU,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;YACxD,MAAM,MAAM,GAAG,qBAAqB,CAAC,MAAM,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;YAEtD,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gEAAgE,EAAE,GAAG,EAAE;YACtE,MAAM,UAAU,GAAG,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YAChD,MAAM,MAAM,GAAG,qBAAqB,CAAC,UAAU,EAAE,CAAC,EAAE,SAAS,CAAC,CAAC;YAE/D,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gEAAgE,EAAE,GAAG,EAAE;YACtE,MAAM,UAAU,GAAG,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YAChD,MAAM,WAAW,GAAG,IAAI,SAAS,CAAC,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACnE,MAAM,MAAM,GAAG,mBAAmB,CAAC,UAAU,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC;YAC/D,MAAM,MAAM,GAAG,qBAAqB,CAAC,MAAM,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC;YAE7D,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+DAA+D,EAAE,GAAG,EAAE;YACrE,MAAM,UAAU,GAAG,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YAChD,MAAM,WAAW,GAAG,IAAI,SAAS,CAAC,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACnE,MAAM,MAAM,GAAG,mBAAmB,CAAC,UAAU,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC;YAC/D,MAAM,MAAM,GAAG,qBAAqB,CAAC,MAAM,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC;YAE7D,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,UAAU,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;IACP,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC","sourcesContent":["import { describe, it, expect } from \"vitest\";\nimport { unpackNullable, unpackNullableBoolean } from \"./unpackNullableUtils\";\nimport BitVector from \"../vector/flat/bitVector\";\nimport { packNullable, packNullableBoolean } from \"../encoding/packNullableUtils\";\n\ndescribe(\"unpackNullableUtils\", () => {\n    describe(\"unpackNullable\", () => {\n        it(\"should return the original array when presentBits is null\", () => {\n            const dataStream = new Int32Array([1, 2, 3]);\n            const packed = packNullable(dataStream, null);\n            const result = unpackNullable(packed, null, 0);\n\n            expect(result).toBe(dataStream);\n            expect(result).toEqual(new Int32Array([1, 2, 3]));\n        });\n\n        it(\"should return the original array when presentBits is undefined\", () => {\n            const dataStream = new Float32Array([1.5, 2.5, 3.5]);\n            const result = unpackNullable(dataStream, undefined, 0);\n\n            expect(result).toBe(dataStream);\n            expect(result).toEqual(new Float32Array([1.5, 2.5, 3.5]));\n        });\n\n        it(\"should return the original BigInt64Array when presentBits is null\", () => {\n            const dataStream = new BigInt64Array([10n, 20n, 30n]);\n            const result = unpackNullable(dataStream, null, 0n);\n\n            expect(result).toBe(dataStream);\n            expect(result).toEqual(new BigInt64Array([10n, 20n, 30n]));\n        });\n\n        it(\"should return the original array when presentBits is fully set\", () => {\n            const dataStream = new BigInt64Array([10n, 20n, 30n]);\n            const presentBits = new BitVector(new Uint8Array([0b111]), 3);\n            const packed = packNullable(dataStream, presentBits);\n            const result = unpackNullable(packed, presentBits, 0n);\n\n            expect(result).toEqual(new BigInt64Array([10n, 20n, 30n]));\n        });\n\n        it(\"should return partial array when presentBits is partially set\", () => {\n            const dataStream = new Int32Array([0, 20, 30]); // first number is \"null\"\n            const presentBits = new BitVector(new Uint8Array([0b110]), 3);\n            const packed = packNullable(dataStream, presentBits);\n            const result = unpackNullable(packed, presentBits, 0);\n\n            expect(result).toEqual(new Int32Array([0, 20, 30]));\n        });\n    });\n\n    describe(\"unpackNullableBoolean\", () => {\n        it(\"should return the original array when presentBits is null\", () => {\n            const dataStream = new Uint8Array([0b11010101]);\n            const packed = packNullableBoolean(dataStream, 8, null);\n            const result = unpackNullableBoolean(packed, 8, null);\n\n            expect(result).toBe(dataStream);\n            expect(result).toEqual(new Uint8Array([0b11010101]));\n        });\n\n        it(\"should return the original array when presentBits is undefined\", () => {\n            const dataStream = new Uint8Array([0b00001111]);\n            const result = unpackNullableBoolean(dataStream, 8, undefined);\n\n            expect(result).toBe(dataStream);\n            expect(result).toEqual(new Uint8Array([0b00001111]));\n        });\n\n        it(\"should return the original array when presentBits is fully set\", () => {\n            const dataStream = new Uint8Array([0b11010101]);\n            const presentBits = new BitVector(new Uint8Array([0b11111111]), 8);\n            const packed = packNullableBoolean(dataStream, 8, presentBits);\n            const result = unpackNullableBoolean(packed, 8, presentBits);\n\n            expect(result).toEqual(new Uint8Array([0b11010101]));\n        });\n\n        it(\"should return partial array when presentBits is partially set\", () => {\n            const dataStream = new Uint8Array([0b11111111]);\n            const presentBits = new BitVector(new Uint8Array([0b11110000]), 8);\n            const packed = packNullableBoolean(dataStream, 8, presentBits);\n            const result = unpackNullableBoolean(packed, 8, presentBits);\n\n            expect(result).toEqual(new Uint8Array([0b11110000]));\n        });\n    });\n});\n"]}